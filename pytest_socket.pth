import os; exec('if config := os.getenv("_PYTEST_SOCKET_SUBPROCESS", None):\n    import json\n    state = None\n    try:\n        import socket\n        from pytest_socket import disable_socket, _create_guarded_connect\n        state = json.loads(config)\n\n        if state["mode"] == "disable":\n            disable_socket(allow_unix_socket=state["allow_unix_socket"])\n        elif state["mode"] == "allow-hosts":\n            socket.socket.connect = _create_guarded_connect(\n                allowed_hosts=state["allowed_hosts"],\n                allow_unix_socket=state["allow_unix_socket"],\n                _pretty_allowed_list=state["_pretty_allowed_list"]\n            )\n\n    except Exception as exc:\n        import sys\n        sys.stderr.write(\n            "pytest-socket: Failed to set up subprocess socket patching.\\n"\n            f"Configuration: {state}\\n"\n            f"{exc.__class__.__name__}: {exc}\\n"\n        )')
